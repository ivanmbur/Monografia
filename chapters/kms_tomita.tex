Now that we have discussed KMS states and the mathematical tool of Tomita-Takesaki theory we are ready to discuss their relationship. In this chapter we will prove the most important theorem of this work. This will show that the modular group induced by a state yields the unique time evolution that makes the state an equilibrium state. Actually most of the mathematical work required has already been done in theorems \ref{thm:KMS_Tomita} and \ref{thm:Dynamics_Tomita}. Our only task now is to translate these results into a deep physical result. 

\section{The Modular Group and KMS States}

\begin{theorem}
Let $\mathfrak{M}$ be a von Neumann algebra and $\omega$ be a normal faithful state. Then $(\mathfrak{M},\alpha)$ is the only $W^*$-dynamical system with respect to which $\omega$ is a $\alpha$-KMS state where $\alpha$  is the modular group of $(\mathfrak{M},\omega)$.
\end{theorem} 

\begin{proof}
First of all let us see that $\omega$ is a $\alpha$-KMS state with $\alpha$ the modular group of $(\mathfrak{M},\omega)$. Let $A,B\in\pi_\omega(\mathfrak{M})$ be self-adjoint. We know by \ref{thm:KMS_Tomita} that there exists a bounded continuous function $f:\overline{\mathfrak{D}_{-1}}\rightarrow\mathbb{C}$ analytic on $\mathfrak{D}_{-1}$ such that 
\begin{equation}
f(t)=\langle A\Omega_\omega, \Delta^{it}B\Omega_\omega\rangle = \langle\Omega_\omega, A\Delta^{it}B\Delta^{-it}\Omega_\omega\rangle
\end{equation}
and 
\begin{equation}
f(t-i)=\langle \Delta^{it}B\Omega_\omega, A\Omega_\omega\rangle = \langle\Omega_\omega, \Delta^{it}B\Delta^{-it}A\Omega_\omega\rangle.
\end{equation}
We may extend this result through linearity to arbitrary $A,B\in\pi_\omega(\mathfrak{M})$. In particular, for all $A,B\in\mathfrak{M}$ there is a continuous bounded function $f:\overline{\mathfrak{D}_{-1}}\rightarrow\mathbb{C}$ such that for all $t\in\mathbb{R}$
\begin{align}
\begin{split}
f(t)&=\langle\Omega_\omega, \pi_\omega (A)\Delta^{it}\pi_\omega(B)\Delta^{-it}\Omega_\omega\rangle=\langle \Omega_\omega,\pi_\omega(A)\pi_\omega(\alpha_t(B))\Omega_\omega\rangle\\
& = \omega(A\alpha_t(B))
\end{split}
\end{align}
and
\begin{align}
\begin{split}
f(t-i) &=\langle\Omega_\omega, \Delta^{it}\pi_\omega(B)\Delta^{-it}\pi_\omega(A)\Omega_\omega\rangle=\langle \Omega_\omega, \pi_\omega(\alpha_t(B))\pi_\omega(A)\Omega_\omega\rangle \\
&=\omega(\alpha_t(B)A)
\end{split}
\end{align}
We conclude that $\omega$ is an $\alpha$-KMS state.

Now let $(\mathfrak{M},\tau)$ be any $W^*$-dynamical system such that $\omega$ is a $\tau$-KMS state. Given that $\omega$ is invariant under $\tau$, there exists a one-parameter unitary group $t\mapsto U_t$ such that $U_t\Omega_\omega=\Omega_\omega$ and $\pi_\omega(\tau_t(A))=U_t\pi_\omega(A)U_{-t}$. Now let $\mathcal{K}=\overline{\{A\Omega_\omega|A\in\pi_\omega(\mathfrak{M})\text{ is self-adjoint}\}}$. Since for all $A\in\pi_\omega(\mathfrak{M})$ self-adjoint we have $U_tAU_{-t}=(U_tAU_{-t})^*$ then $U_tA\Omega=U_tAU_{-t}\Omega\in\mathcal{K}$. We conclude that $U_t\mathcal{K}\subseteq\mathcal{K}$. On the other hand, for all $A,B$ in $\pi_\omega(\mathfrak{M})$ self-adjoint we have since $\omega$ is an $\tau$-KMS state that there exists a bounded continuous function $f:\overline{\mathfrak{D}_{-1}}\rightarrow\mathbb{C}$ analytic on $\mathfrak{D}_{-1}$ such that
\begin{align}
\begin{split}
f(t)&=\omega(\pi_\omega^{-1}(A)\tau_t(\pi_\omega^{-1}(B))) = \omega(\pi_\omega^{-1}(AU_tBU_{-t})) \\
&=\langle\Omega_\omega,AU_tBU_{-t}\Omega_\omega\rangle = \langle A\Omega_\omega,U_tB\Omega\rangle
\end{split}
\end{align}
and
\begin{align}
f(t-i) &=\omega(\tau_t(\pi_\omega^{-1}(B)\pi_\omega^{-1}(A)) = \omega(\pi_\omega^{-1}(U_tBU_{-t}A)) \\
&=\langle \Omega_\omega, U_tBU_{-t}A\Omega_\omega\rangle = \langle U_tB\Omega_\omega, A\Omega_\omega\rangle.
\end{align}
By considering sequences of such functions using the fact that the set of self-adjoint elements in $\pi_\omega(\mathfrak{M})$ is dense in $\mathcal{K}$, for all $x,y\in\mathcal{K}$ we can construct a bounded continuous function $f:\overline{\mathfrak{D}_{-1}}\rightarrow\mathbb{C}$ analytic on $\mathfrak{D}_{-1}$ such that
\begin{equation}
f(t)=\langle x,U_t y\rangle
\end{equation}
and
\begin{equation}
f(t-i) = \langle U_t y,x\rangle.
\end{equation}
Therefore $U_t$ satisfies the KMS condition with respect to $\mathcal{K}$ and by theorem \ref{thm:KMS_Tomita} we have $U_t=\Delta^{it}$.
\end{proof}

\begin{corollary}\label{thm:final}
Let $\mathfrak{M}$ be a von Neumann algebra and $\omega$ be a faithful normal state. Then $(\mathfrak{M},\tau)$ with $\tau_t(A) = \alpha_{-t/\beta}(A)$ and $\alpha$ the modular group of $(\mathfrak{M},\omega)$ is the unique $W^*$-dynamical system such that $\omega$ is a $(\tau,\beta)$-KMS state.
\end{corollary}

\section{The Canonical Dynamical Law of Equilibrium}

After the amount of machinery we developed in chapters \ref{chp:algebra}, \ref{chp:KMS}, and especially in \ref{chp:tomita}, which allowed us to obtain result \ref{thm:final}, we must now sit back and give a physical interpretation to this work. Through the use of $C^*$ and $W^*$-algebras we managed to give a general definition to the notions of observables, states, dynamical laws, and dynamical systems. In this framework we agreed to identify quantum states in thermal equilibrium with KMS states. Then, we studied the Tomita-Takesaki theory of an algebra of observables and a state. Surprisingly, this study yielded a canonical dynamical law which we identified as the modular group. Even more surprisingly the result \ref{thm:final} showed that this dynamical law yielded the only possible dynamical law such that the state was an equilibrium state at some inverse temperature $\beta$!

In the context of modern theoretical physics this result cannot be overstated. If the models presented above are correct, this result means that in the quantum setting instead of searching for a dynamical law in the construction of new theories, we can instead only look for the equilibrium states. Once we are certain that we have identified the correct equilibrium states, result \ref{thm:final} immediately yields the dynamical law. We conclude that this result represents a new technique for model building and a change in the paradigm of the construction of physical theories.  

An example of this assertion is given by the case of Schrödinger's mechanics. In chapter \ref{chp:KMS} we showed that the only KMS states in a finite dimensional dynamical system given by Schrödinger's equation are the Gibbs states. Now assume that we do not know Schrodinger's equation and we want to study some finite  dimensional system, say, a finite spin lattice. Through our knowledge of statistical physics we may arrive at the conclusion that the equilibrium state at inverse temperature $\beta$ is the $\beta$-Gibbs state. Then result \ref{thm:final} guarantees that by postulating the dynamical law to be given by the modular group associated to this state, we would be bound to find Schrodinger's equation. 