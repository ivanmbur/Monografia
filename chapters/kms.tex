Having developed the theory of algebraic quantum mechanics we are now in the correct setting to discuss the theory of KMS states as shown in \cite{Duvenhage1999}. Although starting with an abstract definition, we will use the case of finite dimensional quantum systems to inspire why this is a natural generalization of the Gibbs states presented in \ref{ex:Gibbs}. In particular, they will be invariant under the dynamics of the system justifying therefore their usefulness given the generality of the dynamics we've defined.

\section{Definition and Dynamical Invariance}

\begin{definition}\label{def:KMS}
Let $(\mathcal{A},\tau)$ be a $C^*$ or $W^*$-dynamical system, $\omega$ a state on $\mathcal{A}$ (in the $W^*$ case we demand $\omega$ is normal), $\beta\in\mathbb{R}$,
\begin{align}
\begin{split}
\mathfrak{D}_\beta=\left\{
\begin{array}{lr}
\{z\in\mathbb{C}|0<\im z<\beta\} &\beta \geq 0 \\
\{z\in\mathbb{C}|\beta<\im z<0\} &\beta < 0
\end{array}\right.,
\end{split}
\end{align}  
and $\overline{\mathfrak{D}_\beta}$ be the closure $\mathfrak{D}_\beta$ except for the case $\beta=0$ where we set $\overline{\mathfrak{D}_\beta}=\mathbb{R}$ (we will keep using these sets during the rest of this work). $\omega$ is said to be a $(\tau,\beta)$-KMS state if it satisfies the KMS conditions, that is, for every $A,B\in\mathcal{A}$ there exists a bounded continuous function $F_{A,B}:\overline{\mathfrak{D}_\beta}\rightarrow \mathbb{C}$ (which we will usually refer to as a witness to $\omega$ being a $(\tau,\beta)$-KMS state) analytic on $\mathfrak{D}_\beta$ and such that for every $t\in\mathbb{R}$ it is true that
\begin{align}
\begin{split}
F_{A,B}(t)&=\omega(A\tau_t(B)) \\
F_{A,B}(t+i\beta)&=\omega(\tau_t(B)A).
\end{split}
\end{align}
A $(\tau,-1)$-KMS state is called a $\tau$-KMS state.
\end{definition}

Although the definition of $\tau$-KMS state may seem bizarre since it corresponds to negative temperatures, it is of great technical importance. Indeed the next theorem shows that for the most part everything we learn about $\tau$-KMS states is true for $(\tau,\beta)$-KMS states.

\begin{theorem}
Let $(\mathcal{A},\tau)$ be a $C^*(W^*)$-dynamical system, $\omega$ a state on $\mathcal{A}$, and $\beta\in\mathbb{R}$. Define
\begin{alignat}{2}
\alpha:\mathbb{R}&\rightarrow & \Aut(\mathcal{A}) \nonumber \\
t&\mapsto &\alpha_t:\mathcal{A} & \rightarrow\mathcal{A} \\
&&A&\mapsto \alpha_t(A):=\tau_{-\beta t}(A). \nonumber
\end{alignat}
Then $(\mathcal{A},\alpha)$ is a $C^*(W^*)$-dynamical system and:
\begin{itemize}
\item if $\omega$ is a $(\tau,\beta)$-KMS state then it is an $\alpha$-KMS state;
\item if $\beta\neq 0$ then $\omega$ is a $(\tau,\beta)$-KMS state if and only if it is an $\alpha$-KMS state. 
\end{itemize}
\end{theorem}

\begin{proof}
It is easy to see that $(\mathcal{A},\alpha)$ is a $C^*(W^*)$-dynamical system.
If $\omega$ is a $(\tau,\beta)$-KMS state and $F_{A,B}$ is a witness to this then
\begin{align}
\begin{split}
G_{A,B}:\overline{\mathfrak{D}_{-1}}&\rightarrow\mathbb{C} \\
z&\mapsto F_{A,B}(-\beta z)
\end{split}
\end{align} 
clearly shows that it is an $\alpha$-KMS state.
Conversely assume $\beta\neq 0$ and $\omega$ is an $\alpha$-KMS state. Suppose $G_{A,B}$ is a witness to $\omega$ being an $\alpha$-KMS state. Then  
\begin{align}
\begin{split}
F_{A,B}:\overline{\mathfrak{D}_{-1}}&\rightarrow\mathbb{C} \\
z&\mapsto F_{A,B}(-z/\beta)
\end{split}
\end{align} 
clearly shows it is a $(\tau,\beta)$-KMS state.
\end{proof}

The importance of KMS states becomes immediately obvious due to the next theorem since it shows that KMS states are constant in the dynamics.

\begin{theorem}\label{thm:time_invariance}
Let $(\mathcal{A},\tau)$ be a $C^*$ or $W^*$ dynamical system where $A$ is unital and $\omega$ a $(\tau,\beta)$-KMS state for some $\beta\in\mathbb{R}\setminus\{0\}$. Then for all $A\in\mathcal{A}$ and $t\in\mathbb{R}$ we have $\omega(\tau_t(A))=\omega(A)$.
\end{theorem}

\begin{proof}
By the previous theorem, we might as well assume that $\omega$ is a $\tau$-KMS state. Let $A\in\mathcal{A}$ be self-adjoint. If $F_{1,A}$ is a witness to $\omega$ being a $\tau$-KMS state then for $t\in\mathbb{R}$
\begin{equation}
F_{1,A}(t)=\omega(\tau_t(A))=F_{1,A}(t-i)
\end{equation}
and since $\overline{\omega(\tau_t(A))}=\omega(\tau_t(A)^*)=\omega(\tau_t(A^*))=\omega(\tau_t(A))$ we have that $F_{1,A}(\overline{\mathfrak{D}_{-1}}\setminus\mathfrak{D}_{-1})\subseteq\mathbb{R}$. Given that $F_{1,A}$ is continuous, bounded and analytic on $\mathfrak{D}_{-1}$ we conclude that $F_{1,A}$ is constant (this is an application of Liouville's theorem, see \cite{Duvenhage1999}). Therefore the theorem follows for self-adjoint operators.
If $A\in\mathcal{A}$ we have
\begin{equation}
\omega(\tau_t(A))=\omega\left(\tau_t\left(\frac{A+A^*}{2}\right)\right)+i\omega\left(\tau_t\left(\frac{A-A^*}{2i}\right)\right)
\end{equation}
and each of the terms in the sum are independent of $t$ since the operators are self-adjoint. The theorem follows.
\end{proof}

\section{Gibbs states}

Although we've shown that KMS states are constant under the dynamics of a system, this isn't the only requirement for a description of statistical equilibrium. Other issues like stability should be studied. The step we will give into further justifying the study of this states is to show that they are equivalent to the Gibbs states in the case of a finite dimensional Hilbert space. This will be stated with the use of only one theorem inspired by the work in \cite{Duvenhage1999}.

\begin{theorem}
Let $(\mathcal{B}(\mathcal{H}),\tau)$ be the $C^*(W^*)$-dynamical system discussed in example \ref{ex:schrodinger}. Then a state $\omega$ on $\mathcal{B}(\mathcal{H})$ is a $\beta$-Gibbs state if and only if it is a $(\tau,\beta)$-KMS state.  
\end{theorem}

\begin{proof}
Assume $\omega$ is a $\beta$-Gibbs state. Define for $A,B\in\mathcal{B}(\mathcal{H})$
\begin{align}
\begin{split}
F_{A,B}:\mathbb{C}&\rightarrow\mathbb{C} \\
z&\mapsto \omega(A\tau_z(B))
\end{split}
\end{align}
Then, we have for $t\in\mathbb{R}$ that $F_{A,B}(t)=\omega(A\tau_t(B))$ and 
\begin{align}
\begin{split}
F_{A,B}(t+i\beta)& =\omega(A\tau_{t+i\beta}(B))=\frac{\tr(e^{-\beta H}Ae^{iH(t+i\beta)}Be^{-iH(t+i\beta)})}{\tr e^{-\beta H}} \\
&= \frac{\tr(e^{-\beta H}Ae^{iHt}e^{-\beta H}Be^{-iHt}e^{\beta H})}{\tr e^{-\beta H}} \\
&= \frac{\tr(e^{iHt}e^{-\beta H}Be^{-iHt}e^{\beta H}e^{-\beta H}A)}{\tr e^{-\beta H}} \\
&= \frac{\tr(e^{iHt}e^{-\beta H}Be^{-iHt}A)}{\tr e^{-\beta H}} \\
&= \frac{\tr(e^{-\beta H}e^{iHt}Be^{-iHt}A)}{\tr e^{-\beta H}} = \omega(\tau_t(B)A).
\end{split} 
\end{align}
Moreover, $\omega$ is continuous and doesn't depend on $z$, therefore $F_{A,B}$ is analytic (and continuous which easily follows) due to the product rule and the fact that the exponential is analytic. 
If $\{e_1,\dots,e_N\}$ is an orthonormal basis of eigenvectors of $H$ associated to the eigenvalues $E_1,\dots E_N$ and $P_1,\dots P_n$ are the corresponding projections on the span of each of the vectors, we have for $z\in \overline{\mathfrak{D}_\beta}$
\begin{align}
\begin{split}
\|e^{\pm iHz}\|&=\|\sum_{n=1}^N e^{\pm iE_n z}P_n\|\leq\sum_{n=1}^N |e^{\pm iE_n z}|\|P_n\| \\
&=\sum_{n=1}^N |e^{\pm iE_n z}|=\sum_{n=1}^N |e^{\pm iE_n \re z}e^{\mp E_n \im z}|=\sum_{n=1}^N |e^{\mp E_n \im z}| \\
&=\sum_{n=1}^N e^{\mp E_n \im z}\leq \sum_{n=1}^N e^{|E_n\beta|}.
\end{split}
\end{align}  
Since 
\begin{align}
\begin{split}
\|F_{A,B}(z)\|&=\|\omega(A\tau_z(B))\|\leq\|\omega\|\|A\|\|e^{iHz}\|\|B\|\|e^{-iHz}\| \\
&\leq\|A\|\sum_{n=1}^N e^{|E_n\beta|}\|B\|\sum_{n=1}^N e^{|E_n\beta|},
\end{split}
\end{align}
it follows that $F_{A,B}|_{\overline{\mathfrak{D}_\beta}}$ is bounded and that $\omega$ is a $(\tau,\beta)$-KMS state. \\
Now assume that $\omega$ is a $(\tau,\beta)$-KMS state and let $F_{A,B}$ be witness of this for $A,B\in\mathcal{B}(\mathcal{A})$. Define 
\begin{align}
\begin{split}
G_{A,B}:\mathbb{C}&\rightarrow\mathbb{C} \\
z&\mapsto \omega(A\tau_z(B))
\end{split}
\end{align}
We want to show that $F_{A,B}=G_{A,B}|_{\overline{\mathfrak{D}_\beta}}$ or, equivalently, that
\begin{align}
\begin{split}
f:\overline{\mathfrak{D_\beta}}&\rightarrow\mathbb{C} \\
z&\mapsto F_{A,B}(z)-G_{A,B}(z)
\end{split}
\end{align} 
(which is of course continuous and analytic in $\mathfrak{D}_\beta$) is null. In the case $\beta=0$ this is obvious. Assume $\beta>0$. Note that $D=\{z\in\mathbb{C}|-\beta<\im z<\beta\}$ is a region (that is, open and connected) and $D^*=D$. It is clear that $f(\mathbb{R})=\{0\}$. Then, by the Schwarz reflection principle\cite{Conway1978} there exists an analytic function $g:D\rightarrow\mathbb{C}$ such that $g(z)=f(z)$ in $\mathfrak{D}_\beta\cup\mathbb{R}$. Then, since $g(\mathbb{R})={0}$ we have that $g$ is null\cite{Conway1978}. We conclude that $f(z)=0$ for $z\in\mathfrak{D}_\beta\cup\mathbb{R}$ and therefore is null by continuity. The case $\beta<0$ is analogous.\\
In particular we now have that 
\begin{equation}
\omega(A\tau_{i\beta}(B))=G_{A,B}(i\beta)=F_{A,B}(i\beta)=\omega(\tau_0(B)A)=\omega(BA)\footnote{A simple calculation shows that this equation is always true for $\beta$-Gibbs states. In our present situation we need to prove the converse.}.
\end{equation}
Therefore, if $\{e_1,\dots ,e_N\}$ is an orthonormal basis of eigenvectors of $H$ associated to the eigenvalues $E_1,\dots E_N$ and $\{f_1,\dots,f_N\}$ is the dual basis, we have
\begin{align}
\begin{split}
\omega(A)&=\omega\left(\sum_{n,m=1}^N f_n(Ae_m)e_n\otimes e_m\right)=\sum_{n,m=1}^N f_n(Ae_m)\omega(e_n\otimes e_m) \\
&=\frac{1}{\tr(e^{-\beta H})}\sum_{n,m=1}^N f_n(Ae_m)\tr(e^{-\beta H})\omega(e_n \otimes e_m) \\
&=\frac{1}{\tr(e^{-\beta H})}\sum_{n,m,k=1}^N f_n(Ae_m)e^{-\beta E_k}\omega(e_n\otimes e_m) \\
&=\frac{1}{\tr(e^{-\beta H})}\sum_{n,m,k=1}^Nf_n(Ae_m)e^{-\beta E_k}\omega((e_n\otimes e_k)( e_k\otimes e_m)) \\
\end{split}
\end{align}
where we have used that $(e_n\otimes e_k)(e_k\otimes e_m)=\langle e_k, e_k \rangle (e_n\otimes e_m)=e_n\otimes e_m$. Attempting to put the equation in a form where we can apply our previously derived condition we have
\begin{align}
\begin{split}
\omega(A)&=\frac{1}{\tr(e^{-\beta H})}\sum_{n,m,k=1}^Nf_n(Ae_m)e^{-\beta E_m}\omega((e_n\otimes e_k) e^{-\beta E_k} (e_k\otimes e_m) e^{\beta E_m}) \\
&=\frac{1}{\tr(e^{-\beta H})}\sum_{n,m,k=1}^Nf_n(Ae_m)e^{-\beta E_m}\omega((e_n\otimes e_k) e^{-\beta H} (e_k\otimes e_m) e^{\beta H}) \\
&=\frac{1}{\tr(e^{-\beta H})}\sum_{n,m,k=1}^Nf_n(Ae_m)e^{-\beta E_m}\omega((e_n\otimes e_k) \tau_{i\beta} (e_k\otimes e_m)) \\
&=\frac{1}{\tr(e^{-\beta H})}\sum_{n,m,k=1}^Nf_n(Ae_m)e^{-\beta E_m}\omega( (e_k\otimes e_m)( e_n\otimes e_k))\\
&=\frac{1}{\tr(e^{-\beta H})}\sum_{n,m,k=1}^Nf_n(Ae_m)e^{-\beta E_m}\omega( e_k\otimes e_k)\langle e_m,e_n\rangle\\
&=\frac{1}{\tr(e^{-\beta H})}\sum_{n,m=1}^Nf_n(Ae_m)e^{-\beta E_m}\omega\left(\sum_{k=1}^N \rho_{e_k}\right)\delta_{mn}\\
\end{split}
\end{align}
by noticing that $e_k\otimes e_k=\rho_{e_k}$ using the notation presented in section \ref{sec:QM}. Finally, we have that
\begin{align}
\begin{split}
\omega(A)&=\frac{1}{\tr(e^{-\beta H})}\sum_{n,m=1}^Nf_n(Ae_m)e^{-\beta E_m}\omega(1)\delta_{mn} \\
&=\frac{1}{\tr(e^{-\beta H})}\sum_{n=1}^Nf_n(Ae_n)e^{-\beta E_n} =\frac{\tr(Ae^{-\beta H})}{\tr(e^{-\beta H})}
\end{split}
\end{align}
from which follows that $\omega$ is a $\beta$-Gibbs state.
\end{proof}